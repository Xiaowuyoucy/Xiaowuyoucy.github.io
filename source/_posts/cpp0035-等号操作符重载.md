---
title: 等号操作符重载
date: 2021-05-11 22:24:40
tags:
categories: cpp
doc:
---

# 等号操作符重载

![1620743144288](/images/javawz/1620743144288.png)

```cpp
#define _CRT_SECURE_NO_WARNINGS
#include<iostream>


using namespace std;

class Student
{
public:
	Student();
	Student(const char * tname);
	Student(const Student & s);
	~Student();

	//重载赋值运算符
	Student & operator=(const Student & s);
	friend ostream & operator<<(ostream & cout ,const Student & s);
	static long long sid;
private:
	char * name;
	int nameLen;

	long long id;
};

long long Student::sid = 10000000;
//操作赋值操作符
Student & Student::operator=(const Student & s)
{
	//首先判断是不是本身
	if (&s == this)
	{
		return *this;
	}
	//判断是否为空,如果不为空,就将自身开辟的空间释放掉

	if (this->name != NULL)
	{
		delete[] this -> name;
		this -> name = NULL;
	}
	 
	//执行深拷贝
	this->nameLen = s.nameLen;
	this -> name = new char[this->nameLen + 1];
	strcpy(this->name,s.name);
	this->id = s.id;
	return *this;
}


//拷贝构造函数
Student::Student(const Student & s)
{
	nameLen = s.nameLen;
	id = s.id;
	cout << Student::sid << endl;
	if (s.name == NULL)
	{
		name = NULL;
		return;
	}
	name = new char[nameLen + 1];
	strcpy(name, s.name);

}


ostream & operator<<(ostream & cout, const Student & s)
{
	if (s.name == NULL)
	{
		cout << "学号为"<<s.id<<"该学生无效" << endl;
		return cout;
	}
	cout <<"姓名:" << s.name << endl;
	cout <<"学号:" << s.id << endl;
	cout << "====================" << endl;
	return cout;
}

Student::Student(const char * tname)
{
	nameLen = strlen(tname);
	id = ++sid;

	name = new char[nameLen + 1];
	
	strcpy(name,tname);
}

Student::Student()
{
	name = NULL;
	nameLen = 0;
	id = ++sid;
}

Student::~Student()
{
	if (sid > 10000000)
	{
		--sid;
	}
	
	if (name != NULL)
	{
		cout << name << "  0x" << (int *)name << "   已被析构" << endl;
		delete[] name;
		name = NULL;
	}else
		cout << "NULL" << "  0x" << (int *)name << "   已被析构" << endl;
	
}

int main(char *argv[], int argc)
{
	Student s1, s2("XiaoMing");

	cout << s1 << s2 << endl;

	s1 = s2;
	cout << s1 << endl;

	return 0;
}

```

![1620743161702](/images/javawz/1620743161702.png)